<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pro6PP React SDK Local Test</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 2rem;
        max-width: 600px;
        margin: 0 auto;
      }
      .input-group {
        margin-bottom: 1rem;
      }
      /* Styles for the debug badge */
      .status-badge {
        display: inline-block;
        margin-left: 10px;
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 0.8em;
        color: white;
        background-color: #d32f2f; /* Red for invalid */
        vertical-align: middle;
      }
      .status-badge.valid {
        background-color: #388e3c; /* Green for valid */
      }
    </style>
    <script type="importmap">
      {
        "imports": {
          "react": "https://esm.sh/react@18.2.0",
          "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
          "react-dom": "https://esm.sh/react-dom@18.2.0"
        }
      }
    </script>
  </head>
  <body>
    <h1>Local React SDK Test</h1>
    <div id="root"></div>

    <script type="module">
      import React, { useState, createElement } from 'react';
      import { createRoot } from 'react-dom/client';

      // Import the ESM build of your SDK
      import { Pro6PPInfer } from './dist/index.mjs';

      const root = createRoot(document.getElementById('root'));

      function App() {
        const [result, setResult] = useState(null);
        // 1. Add state to track validity
        const [isValid, setIsValid] = useState(false);

        return createElement('div', null, [
          createElement('div', { className: 'input-group', key: 'input' }, [
            createElement(
              'label',
              {
                key: 'label',
                style: { display: 'block', marginBottom: '0.5rem', fontWeight: 'bold' },
              },
              'Address Search',
              // 2. Render the badge based on state
              createElement(
                'span',
                {
                  key: 'badge',
                  className: `status-badge ${isValid ? 'valid' : ''}`,
                },
                isValid ? 'VALID' : 'INVALID',
              ),
            ),

            createElement(Pro6PPInfer, {
              key: 'infer-component',
              authKey: 'RpeUYR5XsQSGY6Lr',
              country: 'NL',
              apiUrl: 'http://localhost:8081/v2/infer/nl',

              // 3. Hook into state changes
              onStateChange: (state) => {
                setIsValid(state.isValid);
              },

              onSelect: (selection) => {
                console.log('Selection:', selection);
                setResult(selection);
              },
            }),
          ]),

          result &&
            createElement(
              'div',
              {
                key: 'output',
                style: {
                  marginTop: '20px',
                  padding: '10px',
                  background: '#f0f0f0',
                  borderRadius: '4px',
                  whiteSpace: 'pre-wrap',
                },
              },
              JSON.stringify(result, null, 2),
            ),
        ]);
      }

      root.render(createElement(App));
    </script>
  </body>
</html>
